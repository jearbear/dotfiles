; vim: set filetype=gitconfig:
[init]
    defaultBranch = main

[core]
    excludesfile = ~/.gitignore
    pager = delta

[alias]
    ; `&& :` is appended to aliases to stop them from using extra arguments
    ; `set -e; FOO=$(...)` is used to terminate when <C-c> is pressed in FZF
    ; `xargs` will trim for you if you don't provide other arguments

    b = branch
    s = status
    c = commit
    p = push -u
    fp = push -f

    aa = add -A
    ai = !"f() { set -e; FILES=$(git pick files); git add $FILES; }; f"

    d = diff
    ds = diff --staged HEAD
    db = !git diff $(git base) && :
    dbs = !git diff $(git base) --stat && :

    base = !git merge-base ${1:-HEAD} main && :
    branch-name = rev-parse --abbrev-ref HEAD
    head = rev-parse HEAD

    new = !git co -b jerry-${1?} main && :
    newb = !git co -b jerry-${1?} ${2:-HEAD} && :
    backup = !git co -b $(git branch-name)-backup && git co - && :

    save = !"f() { git add -A && git commit -m \"${1:-$(shuf -n 1 ~/.word_list.txt)}\"; git push; }; f"
    resave = !git add -A && git recommit && git push -f && :

    cleanup = !"f() { set -e; BRANCHES=$(git pick branches-without-main); git branch -D $BRANCHES; }; f"

    rename = branch -m

    l = log --oneline main..
    ls = log --oneline --graph --since='1 month ago' --simplify-by-decoration --branches
    lsa = log --oneline --graph --simplify-by-decoration --branches

    mm = !git update && git merge main --no-edit
    mt = mergetool

    ri = !"f() { set -e; BRANCH=$(git pick branch); git rebase --interactive $BRANCH; }; f"
    rim = !git update && git rebase --interactive main && :
    rib = !git rebase --interactive $(git base) && :
    rom = !git update && git rebase main && :
    recon = !git add -A && git rebase --continue

    bmerge = !"f() { set -e; BRANCH=$(git pick branch); git merge --squash $BRANCH && git commit -m \"[MERGED] $BRANCH\"; }; f"

    co = checkout
    com = checkout main
    cob = !"f() { set -e; BRANCH=$(git pick branch); git co $BRANCH; }; f"

    cor = !git fetch origin ${1?}:jerry-${1?} && git checkout jerry-${1?} && :

    update = fetch origin main:main

    unstage = reset -q HEAD
    recommit = commit --amend --no-edit
    uncommit = reset --soft HEAD^

    rev = !"f() { set -e; COMMIT=$(git pick branch-commit); git revert $COMMIT; }; f"
    fix = !"f() { set -e; COMMIT=$(git pick branch-commit); git commit --fixup $COMMIT; }; f"
    afix = !git aa && git fix

    stow = !"if [[ $(git log -1 --format=%B) == '[STOWED]' ]]; then git commit -a --amend --no-edit; else git add -A && git commit -m '[STOWED]'; fi"
    unstow = !"if [[ $(git log -1 --format=%B) == '[STOWED]' ]]; then git reset @^; else echo \"Nothing to unstow\"; fi"

    ci = !gh pr checks
    pr = !hub pull-request --draft --edit --browse --push && :
    open = !"gh pr view --web || open https://$(git remote get-url origin | sed 's/git@//; s/.git//; s/:/\\//')/pull/new/$(git branch-name)"

[commit]
    gpgSign = false
    verbose = true

[color]
    ui = true

[color "diff-highlight"]
    oldNormal = red
    oldHighlight = red bold reverse
    newNormal = green
    newHighlight = green bold reverse

[color "diff"]
    meta = white
    frag = magenta bold
    old = red
    new = green
    whitespace = red reverse

[help]
    autocorrect = 1

[log]
    date = relative

[diff]
    algorithm = patience
    indentheuristic = true
    tool = nvimdiff

[difftool]
    prompt = true

[difftool "nvimdiff"]
    cmd = nvim -d $LOCAL $MERGED -c 'wincmd w'

[merge]
    conflictstyle = diff3
    tool = nvimdiff

[mergetool]
    prompt = false

[mergetool "nvimdiff"]
    cmd = nvim $MERGED

[pull]
    ff = only
    rebase = true

[push]
    default = current

[rebase]
    autostash = true
    autosquash = true

[stash]
    showPatch = true

[include]
    path = .gitconfig.local

[interactive]
    ; make interactive commands such as `git add --patch` use delta to colorize
    diffFilter = delta --color-only

[delta]
    minus-style = red bold
    minus-emph-style = bold underline red
    minus-non-emph-style = red bold
    minus-empty-line-marker-style = normal
    plus-style = green bold
    plus-emph-style = bold underline green
    plus-non-emph-style = green bold
    plus-empty-line-marker-style = normal

    commit-decoration-style = bold yellow box ul
    file-style = bold yellow ul

    line-numbers-minus-style = reverse bold red
    line-numbers-plus-style = reverse bold green

    features = side-by-side
    navigate = true

; Allow commands like `git clone gh:jearbear/dotfiles`
[url "git@github.com:"]
    insteadOf = gh:

; Allow commands like `git clone gh:dotfiles`
[url "git@github.com:jearbear/"]
    insteadOf = me:

[user]
    email = jerrytegno@gmail.com
    name = Jerry Tegno
